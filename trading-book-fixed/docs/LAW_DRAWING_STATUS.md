# LAW_DRAWING_STATUS

## Current render path
- Chart renderer: `src/components/LightweightChart.jsx`.
- Overlay primitives: `priceLine`, HTML `band`, `marker` via `createOverlayRegistry`.
- Applied laws state flows from `AppliedLawContext` to `ChartPage` then into `LightweightChart` as `appliedLaws`.
- Shared indicator baseline + per-law stats are generated by `buildMergedRenderPlan` and consumed in chart and deterministic validator.

## What was missing before
- Baseline overlay was drawn **per law**, producing duplicated fib/HL lines in multi-law mode.
- Most laws had no executable recipe; they fell into generic fallback without explicit per-law mapping reason.
- Deterministic validator lacked feature/reason reporting required for strict completion tracking.

## Indicator subsystems ported from `indicator.txt`
- Unit segmentation and unit OHLC tracking.
- Unit HL lines and fib grid levels including ± extensions.
- Fill bands for 0.236–0.382 and 1.236–1.382.
- Highlight flags: PrevBreakHL, InsideHL, InsideShortHL, BothSidesBreak, Weak123, BackInsideShort.
- Auto-HTF-right proxy model (last completed unit fib set).

## Mapping coverage summary
- Full map for all 48 laws in `src/data/lawIndicatorMap.json`.
- Modes:
  - `recipe_defined`: law has explicit `chartRecipe` overlays.
  - `keyword_mapped`: law inferred via book/indicator keywords and drawn with baseline + safe overlays.
  - `UNKNOWN_MAPPING`: ambiguous after 5-attempt method, rendered with safe fallback (HL + fib + zone + marker + law label).

## Unknown list and reference policy
- Unknown laws remain explicitly listed in `docs/chart-coverage-report.md` with reasons.
- Each unknown includes TODO to resolve only when explicit trigger appears in:
  1. `BOOK_V3_COMBINED.md`
  2. `Ziad_Ikailan_236_FULL_CONTEXT_BOOK_V3.md`
  3. `indicator.txt`
